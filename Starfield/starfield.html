<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starfield</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            overflow: hidden;
            width: 100%;
            height: 100%;
            background: #000;
        }

        #starfield {
            display: block;
            width: 100vw;
            height: 100vh;
        }

        #controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 12px;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 280px;
        }

        .control {
            margin: 12px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .control:first-child {
            margin-top: 0;
        }

        .control:last-child {
            margin-bottom: 0;
        }

        label {
            min-width: 110px;
            font-size: 13px;
            color: #ccc;
        }

        input[type="range"] {
            flex: 1;
            min-width: 120px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 14px;
            height: 14px;
            background: #fff;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.15s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 14px;
            height: 14px;
            background: #fff;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .value {
            min-width: 45px;
            text-align: right;
            font-size: 12px;
            color: #888;
            font-family: 'SF Mono', 'Monaco', monospace;
        }

        @media (prefers-reduced-motion: reduce) {
            #starfield {
                display: none;
            }
            body::after {
                content: 'Animation paused for reduced motion preference';
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                color: #666;
                font-family: sans-serif;
            }
        }

        @media (max-width: 500px) {
            #controls {
                bottom: 10px;
                right: 10px;
                left: 10px;
                min-width: auto;
                padding: 15px;
            }

            label {
                min-width: 90px;
                font-size: 12px;
            }

            input[type="range"] {
                min-width: 80px;
            }
        }
    </style>
</head>
<body>
    <canvas id="starfield" aria-label="Animated starfield effect"></canvas>

    <div id="controls" role="group" aria-label="Starfield controls">
        <div class="control">
            <label for="emission">Star Count</label>
            <input type="range" id="emission" min="1" max="10" value="3" step="1">
            <span class="value" id="emissionVal">3</span>
        </div>

        <div class="control">
            <label for="speed">Speed</label>
            <input type="range" id="speed" min="0.5" max="3" value="1" step="0.1">
            <span class="value" id="speedVal">1.0x</span>
        </div>

        <div class="control">
            <label for="trail">Trail Length</label>
            <input type="range" id="trail" min="0.8" max="0.99" value="0.92" step="0.01">
            <span class="value" id="trailVal">92%</span>
        </div>

        <div class="control">
            <label for="size">Star Size</label>
            <input type="range" id="size" min="0.5" max="4" value="1.5" step="0.1">
            <span class="value" id="sizeVal">1.5px</span>
        </div>

        <div class="control">
            <label for="sizeVar">Size Variation</label>
            <input type="range" id="sizeVar" min="0" max="100" value="50" step="5">
            <span class="value" id="sizeVarVal">50%</span>
        </div>

        <div class="control">
            <label for="speedVar">Speed Variation</label>
            <input type="range" id="speedVar" min="0" max="100" value="60" step="5">
            <span class="value" id="speedVarVal">60%</span>
        </div>

        <div class="control">
            <label for="color">Color Shift</label>
            <input type="range" id="color" min="0" max="100" value="20" step="5">
            <span class="value" id="colorVal">20%</span>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');

        let centerX, centerY;
        let particles = [];
        let lastTime = 0;

        // Settings
        let settings = {
            emission: 3,
            speed: 1,
            trail: 0.92,
            size: 1.5,
            sizeVar: 0.5,
            speedVar: 0.6,
            color: 0.2
        };

        // Particle class
        class Particle {
            constructor() {
                this.reset();
            }

            reset() {
                this.x = centerX;
                this.y = centerY;
                this.angle = Math.random() * Math.PI * 2;

                // Calculate speed with variation
                const baseSpeed = settings.speed * 150;
                const variation = baseSpeed * settings.speedVar;
                this.speed = baseSpeed + (Math.random() - 0.5) * variation;

                // Calculate size with variation
                const sizeVariation = settings.size * settings.sizeVar;
                this.size = settings.size + (Math.random() - 0.5) * sizeVariation;
                this.size = Math.max(0.5, this.size);

                // Velocity based on angle
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;

                // Lifetime
                this.age = 0;
                this.maxAge = 10;

                // Opacity (starts dim, gets brighter as it moves out)
                this.opacity = 0;
            }

            update(dt) {
                // Update position
                this.x += this.vx * dt;
                this.y += this.vy * dt;

                // Age the particle
                this.age += dt;

                // Calculate distance from center for opacity
                const dx = this.x - centerX;
                const dy = this.y - centerY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                const maxDistance = Math.max(canvas.width, canvas.height) / 2;

                // Opacity increases with distance (creates depth effect)
                this.opacity = Math.min(1, distance / 100);

                // Speed increases slightly as particle moves outward (acceleration)
                const acceleration = 1 + (distance / maxDistance) * 0.5;
                this.vx = Math.cos(this.angle) * this.speed * acceleration;
                this.vy = Math.sin(this.angle) * this.speed * acceleration;
            }

            draw() {
                // Calculate color with blue shift
                const blueShift = settings.color;
                const r = Math.round(255 - blueShift * 85);
                const g = Math.round(255 - blueShift * 51);
                const b = 255;

                ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${this.opacity})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }

            isDead() {
                return (
                    this.x < -50 ||
                    this.x > canvas.width + 50 ||
                    this.y < -50 ||
                    this.y > canvas.height + 50 ||
                    this.age > this.maxAge
                );
            }
        }

        // Resize canvas
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            centerX = canvas.width / 2;
            centerY = canvas.height / 2;
        }

        // Animation loop
        function animate(currentTime) {
            const dt = Math.min((currentTime - lastTime) / 1000, 0.1);
            lastTime = currentTime;

            // Semi-transparent clear for trail effect
            const trailAlpha = 1 - settings.trail;
            ctx.fillStyle = `rgba(0, 0, 0, ${trailAlpha})`;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Spawn new particles
            for (let i = 0; i < settings.emission; i++) {
                if (particles.length < 1000) {
                    particles.push(new Particle());
                }
            }

            // Update and draw particles
            particles = particles.filter(p => {
                p.update(dt);
                if (!p.isDead()) {
                    p.draw();
                    return true;
                }
                return false;
            });

            requestAnimationFrame(animate);
        }

        // Setup controls
        function setupControls() {
            // Emission rate
            const emissionSlider = document.getElementById('emission');
            const emissionVal = document.getElementById('emissionVal');
            emissionSlider.addEventListener('input', () => {
                settings.emission = parseInt(emissionSlider.value);
                emissionVal.textContent = emissionSlider.value;
            });

            // Speed
            const speedSlider = document.getElementById('speed');
            const speedVal = document.getElementById('speedVal');
            speedSlider.addEventListener('input', () => {
                settings.speed = parseFloat(speedSlider.value);
                speedVal.textContent = speedSlider.value + 'x';
            });

            // Trail
            const trailSlider = document.getElementById('trail');
            const trailVal = document.getElementById('trailVal');
            trailSlider.addEventListener('input', () => {
                settings.trail = parseFloat(trailSlider.value);
                trailVal.textContent = Math.round(settings.trail * 100) + '%';
            });

            // Size
            const sizeSlider = document.getElementById('size');
            const sizeVal = document.getElementById('sizeVal');
            sizeSlider.addEventListener('input', () => {
                settings.size = parseFloat(sizeSlider.value);
                sizeVal.textContent = sizeSlider.value + 'px';
            });

            // Size variation
            const sizeVarSlider = document.getElementById('sizeVar');
            const sizeVarVal = document.getElementById('sizeVarVal');
            sizeVarSlider.addEventListener('input', () => {
                settings.sizeVar = parseInt(sizeVarSlider.value) / 100;
                sizeVarVal.textContent = sizeVarSlider.value + '%';
            });

            // Speed variation
            const speedVarSlider = document.getElementById('speedVar');
            const speedVarVal = document.getElementById('speedVarVal');
            speedVarSlider.addEventListener('input', () => {
                settings.speedVar = parseInt(speedVarSlider.value) / 100;
                speedVarVal.textContent = speedVarSlider.value + '%';
            });

            // Color shift
            const colorSlider = document.getElementById('color');
            const colorVal = document.getElementById('colorVal');
            colorSlider.addEventListener('input', () => {
                settings.color = parseInt(colorSlider.value) / 100;
                colorVal.textContent = colorSlider.value + '%';
            });
        }

        // Initialize
        window.addEventListener('resize', resize);
        resize();
        setupControls();
        requestAnimationFrame(animate);
    </script>
</body>
</html>
